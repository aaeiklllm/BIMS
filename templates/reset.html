{% extends "base.html" %}
{% load static %}
{% block content %}
<title>Sign In</title>
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css?family=Montserrat:400,800');
 
 .info-msg,
    .success-msg,
    .warning-msg,
    .error-msg {
      margin: 10px 0;
      padding: 10px;
      border-radius: 3px 3px 3px 3px;
    }

    .success-msg {
      color: #270;
      background-color: #DFF2BF;
    }

    .error-msg {
      color: #D8000C;
      background-color: #FFBABA;
    }

    .required::after {
			content: " *";
			color: rgb(185, 24, 24);
			font-size: 14px;
	  }

    .zoomOut {
      transition: transform .2s;
    }

    .zoomOut:hover {
      transform: scale(1.2);
    }

    .circle-shape {
      flex-shrink: 0;
      padding: 0;
      width: 85px;
      height: 85px;
      line-height: 64px;
      border-radius: 50%;
      text-align: center;
      font-size: 32px;
    }

    .bg-accent {
      background-color: #16a085 !important;
    }

    #one {
      margin-top: -3rem !important;
    }

    #button1 {
      background-color: #16a085;
      border-color: #16a085;
    }

    .page-hero {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 75vh;
    }

    .container-home {
      width: 100%;
      text-align: center;
    }

    body {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      background-color: #f8f9fa; /* Light background color */
      color: #644ca4; /* Text color */
      font-family: Helvetica, sans-serif;

      display: flex;                 /* Enable flexbox */
      justify-content: center;       /* Center horizontally */
      align-items: center;  
    }

.btn-primary {
	background-color: #674FA7 !important;
	border-color: #674FA7 !important;
	color: #FFFFFF;
	transition: transform 80ms ease-in;
}

button {
    background-color: #644ca4; /* Green background */
    color: white; /* White text color */
    border: none; /* Remove default border */
    padding: 10px 20px; /* Padding around the text */
    text-align: center; /* Center the text */
    text-decoration: none; /* Remove underline */
    display: inline-block; /* Align the button inline */
    font-size: 16px; /* Increase font size */
    margin: 4px 2px; /* Spacing between buttons */
    cursor: pointer; /* Pointer cursor on hover */
    border-radius: 5px; /* Rounded corners */
    transition: background-color 0.3s, transform 0.2s; /* Transition for smooth effect */
}

button:hover {
    background-color: #5c459b; /* Darker green on hover */
    transform: scale(1.05); /* Slightly increase size */
}

button:active {
	transform: scale(0.95);
}

button:focus {
	outline: none;
}

button.ghost {
	background-color: transparent;
	border-color: #FFFFFF;
}

input {
	background-color: #ffffff;
	border: none;
	padding: 12px 15px;
	margin: 8px 0;
	width: 100%;
}

.container {
    display: flex;                 /* Enable flexbox for the container */
    flex-direction: column;       /* Align children in a column */
    justify-content: center;       /* Center children vertically */
    align-items: center;          /* Center children horizontally */
    height: 100%;                 /* Make the container full height */
    width: 100%;                  /* Make the container full width */
}

form {
    background-color: #eeeeee; /* Background color of form */
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3); /* Add shadow */
    border-radius: 10px;
	  position: relative;
    overflow: hidden;
    display: flex;
    justify-content: center;
    flex-direction: column;
    min-height: 400px;
    padding: 20px 50px; /* Adjust padding for a better look */
    width: 500px; /* Full width of the container */
    max-width: 100%; /* Limit the form width */
}


.form-container {
	position: absolute;
	top: 0;
	height: 100%;
	transition: all 0.6s ease-in-out;
	background-color: #F8DD8C !important;
}

.sign-in-container {
	left: 0;
	width: 50%;
	z-index: 2;
	background-color: #F8DD8C !important;
}

.container.right-panel-active .sign-in-container {
	transform: translateX(100%);
}

.sign-up-container {
	left: 0;
	width: 50%;
	opacity: 0;
	z-index: 1;
	background-color: #F2EDFC !important;
}

.container.right-panel-active .sign-up-container {
	transform: translateX(100%);
	opacity: 1;
	z-index: 5;
	animation: show 0.6s;
}

@keyframes show {
	0%, 49.99% {
		opacity: 0;
		z-index: 1;
	}
	
	50%, 100% {
		opacity: 1;
		z-index: 5;
	}
}

.overlay-container {
	position: absolute;
	top: 0;
	left: 50%;
	width: 50%;
	height: 100%;
	overflow: hidden;
	transition: transform 0.6s ease-in-out;
	z-index: 100;
}

.container.right-panel-active .overlay-container{
	transform: translateX(-100%);
}

.overlay {
	background: #F8DD8C;
	background: -webkit-linear-gradient(to right, #F8DD8C, #F8DD8C);
	background: linear-gradient(to right, #F8DD8C, #F8DD8C);
	background-repeat: no-repeat;
	background-size: cover;
	background-position: 0 0;
	color: #674FA7;
	position: relative;
	left: -100%;
	height: 100%;
	width: 200%;
  	transform: translateX(0);
	transition: transform 0.6s ease-in-out;
}

.container.right-panel-active .overlay {
  	transform: translateX(50%);
}

.overlay-panel {
	position: absolute;
	display: flex;
	align-items: center;
	justify-content: center;
	flex-direction: column;
	padding: 0 40px;
	text-align: center;
	top: 0;
	height: 100%;
	width: 50%;
	transform: translateX(0);
	transition: transform 0.6s ease-in-out;
}

.overlay-left {
	transform: translateX(-20%);
}

.container.right-panel-active .overlay-left {
	transform: translateX(0);
}

.overlay-right {
	right: 0;
	transform: translateX(0);
}

.container.right-panel-active .overlay-right {
	transform: translateX(20%);
}

.social-container {
	margin: 20px 0;
}


.social-container a {
	border: 1px solid #F2EDFC;
	border-radius: 50%;
	display: inline-flex;
	justify-content: center;
	align-items: center;
	margin: 0 5px;
	height: 40px;
	width: 40px;
}

	footer {
	background-color: #644ca4; /* Updated background color */
	width: 100%;
	color: white;
	text-align: center;
	padding: 5px 0; /* Smaller padding for a compact footer */
	font-size: 12px; /* Reduced font size */
	margin: 0
	}

	footer .footer p {
	margin: 0; /* Removes extra margin for a more compact appearance */
	}
	
.newclass img {
  max-width: 100%; /* Set the maximum width of the image to 100% of its container */
  height: auto; /* Ensure the height adjusts proportionally to the width */
}

label{
  text-align: left !important; /* Align text to the left */
}

 </style>   
</head>
<body>
    <div class="container" id="container">
        <form action="{% url 'reset_password' %}" method="post" id="reset-form" required>
            {% csrf_token %}
            <label class ="required" for="code" style="color: rgb(185, 24, 24);">Enter the code sent to your email</label>
            <input type="text" name="code" id="code" required>
            <br>

            <label class ="required" for="new_password">New Password</label>
            <input id="new_password" type="password" name="new_password" 
                   pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}" 
                   title="Must contain at least one number, one uppercase and lowercase letter, and at least 8 or more characters" 
                   required>
		
            <label class ="required" for="confirm_password">Confirm Password</label>
            <input id="confirm_password" type="password" name="confirm_password"  
                   pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}" 
                   title="Must contain at least one number, one uppercase and lowercase letter, and at least 8 or more characters" 
                   required>
		
            <div id="password-error" style="color:red; display:none;">Passwords don't match!</div>
		
            <button type="submit" style="width: 100%;">Submit</button>
            <p style="color: rgb(185, 24, 24); font-size: 14px; text-align: center;"><i>Fields marked with an asterisk (*) are required.</i></p>
        </form>		
    </div> 
</body>


<script>
const signUpButton = document.getElementById('signUp');
const signInButton = document.getElementById('signIn');
const container = document.getElementById('container');

signUpButton.addEventListener('click', () => {
	container.classList.add("right-panel-active");
});

signInButton.addEventListener('click', () => {
	container.classList.remove("right-panel-active");
});

document.getElementById('forgot-password').addEventListener('click', function(event) {
    event.preventDefault();
    
    const username = document.getElementById('username').value;
    if (username === '') {
        alert('Please enter your username first.');
        return;
    }

    // Send AJAX request to backend for password reset
    fetch('/forgot-password/', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': '{{ csrf_token }}'  // Pass the CSRF token
        },
        body: JSON.stringify({ username: username })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            window.location.href = '/reset-password-page/';  // Navigate to code verification page
        } else {
            alert(data.message);
        }
    })
    .catch(error => console.error('Error:', error));
});


const form = document.getElementById('reset-form');

</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
{% endblock %}